<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp"><head><link rel="SHORTCUT ICON" href="./../icons/favicon.ico" /><style type="text/css">.OH_CodeSnippetContainerTabLeftActive, .OH_CodeSnippetContainerTabLeft,.OH_CodeSnippetContainerTabLeftDisabled { backgroundImageName: tabLeftBG.gif; }.OH_CodeSnippetContainerTabRightActive, .OH_CodeSnippetContainerTabRight,.OH_CodeSnippetContainerTabRightDisabled { backgroundImageName: tabRightBG.gif; }.OH_footer { backgroundImageName: footer_slice.gif; background-position: top; background-repeat: repeat-x; }</style><link rel="stylesheet" type="text/css" href="./../styles/branding.css" /><link rel="stylesheet" type="text/css" href="./../styles/branding-en-US.css" /><style type="text/css">
			body
			{
			border-left:5px solid #e6e6e6;
			overflow-x:scroll;
			overflow-y:scroll;
			}
		</style><script src="./../scripts/branding.js" type="text/javascript"><!----></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Perturb-and-Observe Style Experiments and Sensitivity Generation</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="846f840c-9009-47f2-9838-a8f2f6998a0d" /><meta name="Description" content="One of the core strengths of ElecNetKit lies in data manipulation and transformation." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="'true'" /><link type="text/css" rel="stylesheet" href="./../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"><!----></script><meta name="SelfBranded" content="true" /></head><body onload="onLoad()" class="primary-mtps-offline-document"><div class="OH_outerDiv"><div class="OH_outerContent"><table class="TitleTable"><tr><td class="OH_tdTitleColumn">Perturb-and-Observe Style Experiments and Sensitivity Generation</td><td class="OH_tdRunningTitleColumn">ElecNetKit Documentation</td></tr></table><div id="mainSection"><div id="mainBody"><span class="introStyle"></span><div class="introduction"><p>One of the core strengths of ElecNetKit lies in data manipulation and transformation. To that effect, the generation of sensitivity data has been found to be incredibly
      helpful for the purposes of exploring network P-Q-V relationships and planning for the installation of distributed generation, storage, and voltage support systems.</p><p>ElecNetKit features a module designed for simplifying perturb-and-observe-style experiments, and for generating sensitivity information from these experiments. This module is introduced in this topic.</p><p><p>This topic contains the following sections.</p></p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#PerturbAndObserve" target="">Perturb-and-Observe Experiments</a></li><li class="outlineSectionEntry"><a href="#Sensitivities" target="">Determining Sensitivities with Perturb-and-Observe Results</a></li></ul></div><a id="PerturbAndObserve"><!----></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Perturb-and-Observe Experiments</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"></div><p>Perturb-and-Observe Experiments are run using the <span sdata="cer" target="T:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1"><a href="T_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1.htm" target="">PerturbAndObserveRunner<span id="ID0ECABCCAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0ECABCCAAAAA?vb=(Of |cpp=&lt;|cs=&lt;|fs=&lt;'|nu=(");
				</script>TObserve<span id="ID0EAABCCAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EAABCCAAAAA?vb=)|cpp=&gt;|cs=&gt;|fs=&gt;|nu=)");
				</script></a></span> class.</p><h3 class="procedureSubHeading">Setting Up a Perturb-and-Observe Experiment</h3><div class="subSection"><ul><li><p>Specify the <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.NetworkFilename"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_NetworkFilename.htm" target="">NetworkFilename</a></span> of the network to run the perturb-and-observe experiment on.</p></li><li><p>Specify selector functions, that take a <span sdata="cer" target="T:ElecNetKit.NetworkModelling.NetworkModel"><a href="T_ElecNetKit_NetworkModelling_NetworkModel.htm" target="">NetworkModel</a></span> and return a set of <span sdata="cer" target="T:ElecNetKit.NetworkModelling.NetworkElement"><a href="T_ElecNetKit_NetworkModelling_NetworkElement.htm" target="">NetworkElement</a></span>s. You should specify a selector function for all elements that are to be perturbed (<span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.PerturbElementSelector"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_PerturbElementSelector.htm" target="">PerturbElementSelector</a></span>) and for all elements that are to be observed (<span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.ObserveElementSelector"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_ObserveElementSelector.htm" target="">ObserveElementSelector</a></span>). It is common to set the observed elements to the buses in the network, for example:</p><div id="ID0EBDAACAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EBDAACAAAAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EBDAACAAAAA_tabimgleft"></div><div id="ID0EBDAACAAAAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EBDAACAAAAA','C#','1','4');return false;">C#</a></div><div id="ID0EBDAACAAAAA_tab2" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>VB</a></div><div id="ID0EBDAACAAAAA_tab3" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>C++</a></div><div id="ID0EBDAACAAAAA_tab4" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EBDAACAAAAA_tabimgright"></div></div><div id="ID0EBDAACAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EBDAACAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EBDAACAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EBDAACAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EBDAACAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EBDAACAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EBDAACAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EBDAACAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre>myPerturbAndObserveRunner.ObserveElementSelector = network =&gt; network.Buses.Values;</pre></div><div id="ID0EBDAACAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>myPerturbAndObserveRunner.ObserveElementSelector = network =&gt; network.Buses.Values;</pre></div><div id="ID0EBDAACAAAAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBDAACAAAAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBDAACAAAAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBDAACAAAAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBDAACAAAAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBDAACAAAAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div></div></div><script>addSpecificTextLanguageTagSet('ID0EBDAACAAAAA');</script><p>
                  The choice of <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.PerturbElementSelector"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_PerturbElementSelector.htm" target="">PerturbElementSelector</a></span> is a little more arbitrary due to the way that perturbation commands are issued to the simulator (this will be explained later).
                </p></li><li><p>Specify value selector functions <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.PerturbElementValuesSelector"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_PerturbElementValuesSelector.htm" target="">PerturbElementValuesSelector</a></span> and <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.ObserveElementValuesSelector"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_ObserveElementValuesSelector.htm" target="">ObserveElementValuesSelector</a></span>. These take the network elements selected by <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.PerturbElementSelector"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_PerturbElementSelector.htm" target="">PerturbElementSelector</a></span> and <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.ObserveElementSelector"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_ObserveElementSelector.htm" target="">ObserveElementSelector</a></span>, and obtain values that will be observed or used in the perturbation command. For example, if we wish to observe the bus voltages, we can use the statement:</p><div id="ID0EDCAACAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EDCAACAAAAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EDCAACAAAAA_tabimgleft"></div><div id="ID0EDCAACAAAAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EDCAACAAAAA','C#','1','4');return false;">C#</a></div><div id="ID0EDCAACAAAAA_tab2" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>VB</a></div><div id="ID0EDCAACAAAAA_tab3" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>C++</a></div><div id="ID0EDCAACAAAAA_tab4" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EDCAACAAAAA_tabimgright"></div></div><div id="ID0EDCAACAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EDCAACAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EDCAACAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EDCAACAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EDCAACAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EDCAACAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EDCAACAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EDCAACAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre>myPerturbAndObserveRunner.ObserveElementValuesSelector = networkElement =&gt; ((Bus)networkElement).Voltage.Magnitude;</pre></div><div id="ID0EDCAACAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>myPerturbAndObserveRunner.ObserveElementValuesSelector = networkElement =&gt; ((Bus)networkElement).Voltage.Magnitude;</pre></div><div id="ID0EDCAACAAAAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EDCAACAAAAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EDCAACAAAAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EDCAACAAAAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EDCAACAAAAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EDCAACAAAAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div></div></div><script>addSpecificTextLanguageTagSet('ID0EDCAACAAAAA');</script><p>
                  As an example of pulling data from perturbation elements to be used in the perturbation command, the following two commands specify perturbation on buses, and select some values to populate the perturbation commands:
                </p><div id="ID0EBCAACAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EBCAACAAAAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EBCAACAAAAA_tabimgleft"></div><div id="ID0EBCAACAAAAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EBCAACAAAAA','C#','1','4');return false;">C#</a></div><div id="ID0EBCAACAAAAA_tab2" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>VB</a></div><div id="ID0EBCAACAAAAA_tab3" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>C++</a></div><div id="ID0EBCAACAAAAA_tab4" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EBCAACAAAAA_tabimgright"></div></div><div id="ID0EBCAACAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EBCAACAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EBCAACAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EBCAACAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EBCAACAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EBCAACAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EBCAACAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EBCAACAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre>myPerturbAndObserveRunner.PerturbElementSelector = network =&gt; network.Buses.Values;
myPerturbAndObserveRunner.PerturbElementValuesSelector = bus =&gt; <span class="highlight-keyword">new</span> Object[] {bus.ID};</pre></div><div id="ID0EBCAACAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>myPerturbAndObserveRunner.PerturbElementSelector = network =&gt; network.Buses.Values;
myPerturbAndObserveRunner.PerturbElementValuesSelector = bus =&gt; new Object[] {bus.ID};</pre></div><div id="ID0EBCAACAAAAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBCAACAAAAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBCAACAAAAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBCAACAAAAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBCAACAAAAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBCAACAAAAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div></div></div><script>addSpecificTextLanguageTagSet('ID0EBCAACAAAAA');</script><p>In the above example, only the bus ID is selected. The data that needs to be selected depends upon the specific use case and perturbation commands.</p></li><li><p>Specify a set of <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.PerturbCommands"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_PerturbCommands.htm" target="">PerturbCommands</a></span>. Each command can have optional placeholders that will be filled in with values from the <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.PerturbElementValuesSelector"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_PerturbElementValuesSelector.htm" target="">PerturbElementValuesSelector</a></span> specified earlier. Placeholders are specified as <span class="code">{0}</span>, <span class="code">{1}</span>, <span class="code">{2}</span> etc., where the number between the curly braces is the index in the array of objects returned by the value selector. For example, if the <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.PerturbElementValuesSelector"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_PerturbElementValuesSelector.htm" target="">PerturbElementValuesSelector</a></span>
              returned <span class="code">{25, "myBus", 11}</span>, the command string
              </p><div id="ID0EFBAACAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EFBAACAAAAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EFBAACAAAAA_tabimgleft"></div><div id="ID0EFBAACAAAAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true" disabled="true"><a>C#</a></div><div id="ID0EFBAACAAAAA_tab2" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>VB</a></div><div id="ID0EFBAACAAAAA_tab3" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>C++</a></div><div id="ID0EFBAACAAAAA_tab4" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EFBAACAAAAA_tabimgright"></div></div><div id="ID0EFBAACAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EFBAACAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EFBAACAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EFBAACAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EFBAACAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EFBAACAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EFBAACAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EFBAACAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre><span class="highlight-literal">"new Generator.testgenerator-{1} bus1={1} phases=3 model=1 status=fixed kV={2} Vminpu=0.9 Vmaxpu=1.1 kW={0} kvAR=0"</span></pre></div><div id="ID0EFBAACAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>"new Generator.testgenerator-{1} bus1={1} phases=3 model=1 status=fixed kV={2} Vminpu=0.9 Vmaxpu=1.1 kW={0} kvAR=0"</pre></div><div id="ID0EFBAACAAAAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EFBAACAAAAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EFBAACAAAAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EFBAACAAAAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EFBAACAAAAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EFBAACAAAAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div></div></div><script>addSpecificTextLanguageTagSet('ID0EFBAACAAAAA');</script><p>would resolve to</p><div id="ID0EDBAACAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EDBAACAAAAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EDBAACAAAAA_tabimgleft"></div><div id="ID0EDBAACAAAAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true" disabled="true"><a>C#</a></div><div id="ID0EDBAACAAAAA_tab2" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>VB</a></div><div id="ID0EDBAACAAAAA_tab3" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>C++</a></div><div id="ID0EDBAACAAAAA_tab4" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EDBAACAAAAA_tabimgright"></div></div><div id="ID0EDBAACAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EDBAACAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EDBAACAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EDBAACAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EDBAACAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EDBAACAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EDBAACAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EDBAACAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre><span class="highlight-literal">"new Generator.testgenerator-myBus bus1=myBus phases=3 model=1 status=fixed kV=11 Vminpu=0.9 Vmaxpu=1.1 kW=25 kvAR=0"</span></pre></div><div id="ID0EDBAACAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>"new Generator.testgenerator-myBus bus1=myBus phases=3 model=1 status=fixed kV=11 Vminpu=0.9 Vmaxpu=1.1 kW=25 kvAR=0"</pre></div><div id="ID0EDBAACAAAAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EDBAACAAAAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EDBAACAAAAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EDBAACAAAAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EDBAACAAAAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EDBAACAAAAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div></div></div><script>addSpecificTextLanguageTagSet('ID0EDBAACAAAAA');</script><p>You can set up this command string using the code:</p><div id="ID0EBBAACAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EBBAACAAAAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EBBAACAAAAA_tabimgleft"></div><div id="ID0EBBAACAAAAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EBBAACAAAAA','C#','1','4');return false;">C#</a></div><div id="ID0EBBAACAAAAA_tab2" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>VB</a></div><div id="ID0EBBAACAAAAA_tab3" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>C++</a></div><div id="ID0EBBAACAAAAA_tab4" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EBBAACAAAAA_tabimgright"></div></div><div id="ID0EBBAACAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EBBAACAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EBBAACAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EBBAACAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EBBAACAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EBBAACAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EBBAACAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EBBAACAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre>myPerturbAndObserveRunner.PerturbCommands = <span class="highlight-keyword">new</span> String[] { <span class="highlight-literal">"new Generator.testgenerator-{1} bus1={1} phases=3 model=1 status=fixed kV={2} Vminpu=0.9 Vmaxpu=1.1 kW={0} kvAR=0"</span>};</pre></div><div id="ID0EBBAACAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>myPerturbAndObserveRunner.PerturbCommands = new String[] { "new Generator.testgenerator-{1} bus1={1} phases=3 model=1 status=fixed kV={2} Vminpu=0.9 Vmaxpu=1.1 kW={0} kvAR=0"};</pre></div><div id="ID0EBBAACAAAAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBBAACAAAAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBBAACAAAAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBBAACAAAAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBBAACAAAAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBBAACAAAAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div></div></div><script>addSpecificTextLanguageTagSet('ID0EBBAACAAAAA');</script><div class="alert"><table><tr><th><img class="mtps-img-src" src="./../icons/alert_note.gif" alt="Tip" /> <b>Tip</b></th></tr><tr><td><p>You can specify multiple commands to be run in sequence by adding a comma and another command immediately before the closing curly brace:
                </p><p><span class="code">myPerturbAndObserveRunner.PerturbCommands = new String[] { "command1", "command2"};</span></p></td></tr></table></div></li><li><p>Now, call <span sdata="cer" target="M:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.RunPerturbAndObserve"><a href="M_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_RunPerturbAndObserve.htm" target="">RunPerturbAndObserve</a></span> to run the perturb-and-observe experiment. The perturbations given by the <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.PerturbCommands"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_PerturbCommands.htm" target="">PerturbCommands</a></span> will be applied at each element in <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.PerturbElementSelector"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_PerturbElementSelector.htm" target="">PerturbElementSelector</a></span> individually. The observed values before and after perturbation will be stored in <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.BeforeValues"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_BeforeValues.htm" target="">BeforeValues</a></span> and <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.AfterValues"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_AfterValues.htm" target="">AfterValues</a></span>. See the documentation for each of those members for a description of the way that observed data is stored.</p></li></ul></div><a id="Sensitivities"><!----></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Determining Sensitivities with Perturb-and-Observe Results</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"></div><p>Once a Perturb-and-Observe experiment has been run, the <span sdata="cer" target="T:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1"><a href="T_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1.htm" target="">PerturbAndObserveRunner<span id="ID0ECADCAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0ECADCAAAAAA?vb=(Of |cpp=&lt;|cs=&lt;|fs=&lt;'|nu=(");
				</script>TObserve<span id="ID0EAADCAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EAADCAAAAAA?vb=)|cpp=&gt;|cs=&gt;|fs=&gt;|nu=)");
				</script></a></span> can be passed to a <span sdata="cer" target="T:ElecNetKit.Sensitivities.SensitivityGenerator`1"><a href="T_ElecNetKit_Sensitivities_SensitivityGenerator_1.htm" target="">SensitivityGenerator<span id="ID0ECABCAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0ECABCAAAAAA?vb=(Of |cpp=&lt;|cs=&lt;|fs=&lt;'|nu=(");
				</script>T<span id="ID0EAABCAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EAABCAAAAAA?vb=)|cpp=&gt;|cs=&gt;|fs=&gt;|nu=)");
				</script></a></span> to generate the sensitivities of the observed quantities to the perturbed quantities.</p><h3 class="procedureSubHeading">Generating Sensitivity Information from Perturb-and-Observe Results</h3><div class="subSection"><ul><li><p>Instantiate a new <span sdata="cer" target="T:ElecNetKit.Sensitivities.SensitivityGenerator`1"><a href="T_ElecNetKit_Sensitivities_SensitivityGenerator_1.htm" target="">SensitivityGenerator<span id="ID0ECABADAAAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0ECABADAAAAAAAA?vb=(Of |cpp=&lt;|cs=&lt;|fs=&lt;'|nu=(");
				</script>T<span id="ID0EAABADAAAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EAABADAAAAAAAA?vb=)|cpp=&gt;|cs=&gt;|fs=&gt;|nu=)");
				</script></a></span>.</p></li><li><p>Set the <span sdata="cer" target="P:ElecNetKit.Sensitivities.SensitivityGenerator`1.ResultSelector"><a href="P_ElecNetKit_Sensitivities_SensitivityGenerator_1_ResultSelector.htm" target="">ResultSelector</a></span> to a function that takes the observed results provided by the <span sdata="cer" target="T:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1"><a href="T_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1.htm" target="">PerturbAndObserveRunner<span id="ID0ECADBCAAAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0ECADBCAAAAAAAA?vb=(Of |cpp=&lt;|cs=&lt;|fs=&lt;'|nu=(");
				</script>TObserve<span id="ID0EAADBCAAAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EAADBCAAAAAAAA?vb=)|cpp=&gt;|cs=&gt;|fs=&gt;|nu=)");
				</script></a></span>
               and transforms them into some numerical quantity that can be converted to <span sdata="cer" target="T:System.Double"><img src="./../icons/online_icon.gif" class="OH_offlineIcon" alt="Online" title="Online" /><a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">Double</a></span>. For most cases, one of these lines of code will suffice:</p><div id="ID0EACAAAAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EACAAAAAAAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EACAAAAAAAA_tabimgleft"></div><div id="ID0EACAAAAAAAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EACAAAAAAAA','C#','1','4');return false;">C#</a></div><div id="ID0EACAAAAAAAA_tab2" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>VB</a></div><div id="ID0EACAAAAAAAA_tab3" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>C++</a></div><div id="ID0EACAAAAAAAA_tab4" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EACAAAAAAAA_tabimgright"></div></div><div id="ID0EACAAAAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EACAAAAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EACAAAAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EACAAAAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EACAAAAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EACAAAAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EACAAAAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EACAAAAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre><span class="highlight-comment">//Use this if you're observing a complex number and the magnitude component is important.</span>
mySensitivityGenerator.ResultSelector = complex =&gt; complex.Magnitude;
<span class="highlight-comment">//Use this if you're observing a simple number (double, int, etc)</span>
mySensitivityGenerator.ResultSelector = x =&gt; x;</pre></div><div id="ID0EACAAAAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>//Use this if you're observing a complex number and the magnitude component is important.
mySensitivityGenerator.ResultSelector = complex =&gt; complex.Magnitude;
//Use this if you're observing a simple number (double, int, etc)
mySensitivityGenerator.ResultSelector = x =&gt; x;</pre></div><div id="ID0EACAAAAAAAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EACAAAAAAAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EACAAAAAAAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EACAAAAAAAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EACAAAAAAAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EACAAAAAAAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div></div></div><script>addSpecificTextLanguageTagSet('ID0EACAAAAAAAA');</script></li><li><p>
                  Set the <span sdata="cer" target="P:ElecNetKit.Sensitivities.SensitivityGenerator`1.RecordedPerturbationSelector"><a href="P_ElecNetKit_Sensitivities_SensitivityGenerator_1_RecordedPerturbationSelector.htm" target="">RecordedPerturbationSelector</a></span> to obtain a value from the recorded perturbation values. Remember how before we had set of values that we got from <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.PerturbElementValuesSelector"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_PerturbElementValuesSelector.htm" target="">PerturbElementValuesSelector</a></span>? These got passed to the <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.PerturbCommands"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_PerturbCommands.htm" target="">PerturbCommands</a></span>, and the example we used was <span class="code">{25, "myBus", 11}</span>. We need to extract a numerical value from this array to obtain some kind of quantifiable cause-and-effect relationship. The way to do this is through the <span sdata="cer" target="P:ElecNetKit.Sensitivities.SensitivityGenerator`1.RecordedPerturbationSelector"><a href="P_ElecNetKit_Sensitivities_SensitivityGenerator_1_RecordedPerturbationSelector.htm" target="">RecordedPerturbationSelector</a></span>, but we've got a couple of options:
                </p><ul><li><p>Option 1: Limit what gets recorded by the <span sdata="cer" target="T:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1"><a href="T_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1.htm" target="">PerturbAndObserveRunner<span id="ID0ECADBBCBAAAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0ECADBBCBAAAAAAAA?vb=(Of |cpp=&lt;|cs=&lt;|fs=&lt;'|nu=(");
				</script>TObserve<span id="ID0EAADBBCBAAAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EAADBBCBAAAAAAAA?vb=)|cpp=&gt;|cs=&gt;|fs=&gt;|nu=)");
				</script></a></span> with the <span sdata="cer" target="P:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1.PerturbValuesToRecord"><a href="P_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1_PerturbValuesToRecord.htm" target="">PerturbValuesToRecord</a></span> property, and then just select that:</p><div id="ID0EABCBAAAAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EABCBAAAAAAAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EABCBAAAAAAAA_tabimgleft"></div><div id="ID0EABCBAAAAAAAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EABCBAAAAAAAA','C#','1','4');return false;">C#</a></div><div id="ID0EABCBAAAAAAAA_tab2" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>VB</a></div><div id="ID0EABCBAAAAAAAA_tab3" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>C++</a></div><div id="ID0EABCBAAAAAAAA_tab4" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EABCBAAAAAAAA_tabimgright"></div></div><div id="ID0EABCBAAAAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EABCBAAAAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EABCBAAAAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EABCBAAAAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EABCBAAAAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EABCBAAAAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EABCBAAAAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EABCBAAAAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre><span class="highlight-comment">//Take {25, "myBus", 11} and only save 25</span>
myPerturbAndObserveRunner.PerturbValuesToRecord = array =&gt; array[<span class="highlight-number">0</span>];
<span class="highlight-comment">//do the rest of the setup and call myPerturbAndObserveRunner.RunPerturbAndObserve();</span> 

<span class="highlight-comment">//Just pull in that 25</span>
mySensitivityGenerator.RecordedPerturbationSelector = x =&gt; x;</pre></div><div id="ID0EABCBAAAAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>//Take {25, "myBus", 11} and only save 25
myPerturbAndObserveRunner.PerturbValuesToRecord = array =&gt; array[0];
//do the rest of the setup and call myPerturbAndObserveRunner.RunPerturbAndObserve(); 

//Just pull in that 25
mySensitivityGenerator.RecordedPerturbationSelector = x =&gt; x;</pre></div><div id="ID0EABCBAAAAAAAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EABCBAAAAAAAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EABCBAAAAAAAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EABCBAAAAAAAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EABCBAAAAAAAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EABCBAAAAAAAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div></div></div><script>addSpecificTextLanguageTagSet('ID0EABCBAAAAAAAA');</script></li><li><p>Option 2: Record everything from the perturb-and-observe experiment and then just select the relevant data with <span sdata="cer" target="P:ElecNetKit.Sensitivities.SensitivityGenerator`1.RecordedPerturbationSelector"><a href="P_ElecNetKit_Sensitivities_SensitivityGenerator_1_RecordedPerturbationSelector.htm" target="">RecordedPerturbationSelector</a></span>:</p><div id="ID0EAACBAAAAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EAACBAAAAAAAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EAACBAAAAAAAA_tabimgleft"></div><div id="ID0EAACBAAAAAAAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EAACBAAAAAAAA','C#','1','4');return false;">C#</a></div><div id="ID0EAACBAAAAAAAA_tab2" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>VB</a></div><div id="ID0EAACBAAAAAAAA_tab3" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>C++</a></div><div id="ID0EAACBAAAAAAAA_tab4" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EAACBAAAAAAAA_tabimgright"></div></div><div id="ID0EAACBAAAAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EAACBAAAAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EAACBAAAAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EAACBAAAAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EAACBAAAAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EAACBAAAAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EAACBAAAAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EAACBAAAAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre><span class="highlight-comment">//run the Perturb and Observe experiment without setting PerturbAndObserveRunner.PerturbValuesToRecord</span> 

<span class="highlight-comment">//pull in that 25, the first recorded element of the array.</span>
mySensitivityGenerator.RecordedPerturbationSelector = data =&gt; ((Object[])data)[<span class="highlight-number">0</span>];</pre></div><div id="ID0EAACBAAAAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>//run the Perturb and Observe experiment without setting PerturbAndObserveRunner.PerturbValuesToRecord 

//pull in that 25, the first recorded element of the array.
mySensitivityGenerator.RecordedPerturbationSelector = data =&gt; ((Object[])data)[0];</pre></div><div id="ID0EAACBAAAAAAAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EAACBAAAAAAAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EAACBAAAAAAAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EAACBAAAAAAAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EAACBAAAAAAAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EAACBAAAAAAAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div></div></div><script>addSpecificTextLanguageTagSet('ID0EAACBAAAAAAAA');</script></li></ul><p>
              Option 2 is especially useful for situations in which you would use the same perturb-and-observe results for multiple purposes, including a sensitivity calculation, because no loss of data occurs.
              </p><div class="alert"><table><tr><th><img class="mtps-img-src" src="./../icons/alert_note.gif" alt="Note" /> <b>Note</b></th></tr><tr><td>
                The output of <span sdata="cer" target="P:ElecNetKit.Sensitivities.SensitivityGenerator`1.RecordedPerturbationSelector"><a href="P_ElecNetKit_Sensitivities_SensitivityGenerator_1_RecordedPerturbationSelector.htm" target="">RecordedPerturbationSelector</a></span> needs to be convertible to <span sdata="cer" target="T:System.Double"><img src="./../icons/online_icon.gif" class="OH_offlineIcon" alt="Online" title="Online" /><a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">Double</a></span>, and thus needs to be a simple number.</td></tr></table></div></li><li><p>Call <span sdata="cer" target="M:ElecNetKit.Sensitivities.SensitivityGenerator`1.GenerateSensitivities(ElecNetKit.Sensitivities.PerturbAndObserveRunner{`0})"><a href="M_ElecNetKit_Sensitivities_SensitivityGenerator_1_GenerateSensitivities.htm" target="">GenerateSensitivities</a></span>, passing the <span sdata="cer" target="T:ElecNetKit.Sensitivities.PerturbAndObserveRunner`1"><a href="T_ElecNetKit_Sensitivities_PerturbAndObserveRunner_1.htm" target="">PerturbAndObserveRunner<span id="ID0ECABBAAAAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0ECABBAAAAAAAAA?vb=(Of |cpp=&lt;|cs=&lt;|fs=&lt;'|nu=(");
				</script>TObserve<span id="ID0EAABBAAAAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EAABBAAAAAAAAA?vb=)|cpp=&gt;|cs=&gt;|fs=&gt;|nu=)");
				</script></a></span> as a parameter:</p><div id="ID0EAAAAAAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EAAAAAAAAAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EAAAAAAAAAA_tabimgleft"></div><div id="ID0EAAAAAAAAAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EAAAAAAAAAA','C#','1','4');return false;">C#</a></div><div id="ID0EAAAAAAAAAA_tab2" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>VB</a></div><div id="ID0EAAAAAAAAAA_tab3" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>C++</a></div><div id="ID0EAAAAAAAAAA_tab4" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EAAAAAAAAAA_tabimgright"></div></div><div id="ID0EAAAAAAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EAAAAAAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EAAAAAAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EAAAAAAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EAAAAAAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EAAAAAAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EAAAAAAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EAAAAAAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre>mySensitivityGenerator.GenerateSensitivities(myPerturbAndObserveRunner);</pre></div><div id="ID0EAAAAAAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>mySensitivityGenerator.GenerateSensitivities(myPerturbAndObserveRunner);</pre></div><div id="ID0EAAAAAAAAAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EAAAAAAAAAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EAAAAAAAAAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EAAAAAAAAAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EAAAAAAAAAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EAAAAAAAAAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div></div></div><script>addSpecificTextLanguageTagSet('ID0EAAAAAAAAAA');</script></li></ul></div></div></div></div></div><div id="OH_footer" class="OH_footer"><p /><div class="OH_feedbacklink"><a href="mailto:?subject=ElecNetKit+Documentation+Perturb-and-Observe+Style+Experiments+and+Sensitivity+Generation+100+EN-US&amp;body=Your%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report%2c%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed%2c%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed."></a></div></div></body></html>