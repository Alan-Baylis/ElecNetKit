<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp"><head><link rel="SHORTCUT ICON" href="./../icons/favicon.ico" /><style type="text/css">.OH_CodeSnippetContainerTabLeftActive, .OH_CodeSnippetContainerTabLeft,.OH_CodeSnippetContainerTabLeftDisabled { backgroundImageName: tabLeftBG.gif; }.OH_CodeSnippetContainerTabRightActive, .OH_CodeSnippetContainerTabRight,.OH_CodeSnippetContainerTabRightDisabled { backgroundImageName: tabRightBG.gif; }.OH_footer { backgroundImageName: footer_slice.gif; background-position: top; background-repeat: repeat-x; }</style><link rel="stylesheet" type="text/css" href="./../styles/branding.css" /><link rel="stylesheet" type="text/css" href="./../styles/branding-en-US.css" /><style type="text/css">
			body
			{
			border-left:5px solid #e6e6e6;
			overflow-x:scroll;
			overflow-y:scroll;
			}
		</style><script src="./../scripts/branding.js" type="text/javascript"><!----></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Traversing the Network Model</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="dbdbbdc6-bd5c-4f0c-87a1-a5bdeb27b02c" /><meta name="Description" content="This article discusses techniques for accessing properties of electrical network elements, and for navigating between elements of the electrical network model." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="'true'" /><link type="text/css" rel="stylesheet" href="./../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"><!----></script><meta name="SelfBranded" content="true" /></head><body onload="onLoad()" class="primary-mtps-offline-document"><div class="OH_outerDiv"><div class="OH_outerContent"><table class="TitleTable"><tr><td class="OH_tdTitleColumn">Traversing the Network Model</td><td class="OH_tdRunningTitleColumn">ElecNetKit Documentation</td></tr></table><div id="mainSection"><div id="mainBody"><span class="introStyle"></span><div class="introduction"><p>This article discusses techniques for accessing properties of electrical network elements, and for navigating between elements of the electrical network model.</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#accessingProperties" target="">Accessing Network Element Properties</a></li><li class="outlineSectionEntry"><a href="#topology" target="">Traversing the Network Topology</a></li></ul></div><a id="accessingProperties"><!----></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Accessing Network Element Properties</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"></div><p>Each <span sdata="cer" target="T:ElecNetKit.NetworkModelling.NetworkElement"><a href="T_ElecNetKit_NetworkModelling_NetworkElement.htm" target="">NetworkElement</a></span> has a number of properties that define network characteristics. For information on which properties are defined by which network elements, see:
      </p><ul><li><span sdata="cer" target="T:ElecNetKit.NetworkModelling.Bus"><a href="T_ElecNetKit_NetworkModelling_Bus.htm" target="">Bus</a></span></li><li><span sdata="cer" target="T:ElecNetKit.NetworkModelling.Generator"><a href="T_ElecNetKit_NetworkModelling_Generator.htm" target="">Generator</a></span></li><li><span sdata="cer" target="T:ElecNetKit.NetworkModelling.Line"><a href="T_ElecNetKit_NetworkModelling_Line.htm" target="">Line</a></span></li><li><span sdata="cer" target="T:ElecNetKit.NetworkModelling.Load"><a href="T_ElecNetKit_NetworkModelling_Load.htm" target="">Load</a></span></li><li><span sdata="cer" target="T:ElecNetKit.NetworkModelling.NetworkElement"><a href="T_ElecNetKit_NetworkModelling_NetworkElement.htm" target="">NetworkElement</a></span></li><li><span sdata="cer" target="T:ElecNetKit.NetworkModelling.NetworkModel"><a href="T_ElecNetKit_NetworkModelling_NetworkModel.htm" target="">NetworkModel</a></span></li></ul><p>As a general pattern, phased properties (any property that contains information on a per-phase basis) has the word <span class="code">Phased</span> as a suffix, e.g. <span sdata="cer" target="P:ElecNetKit.NetworkModelling.Bus.VoltagePhased"><a href="P_ElecNetKit_NetworkModelling_Bus_VoltagePhased.htm" target="">VoltagePhased</a></span> and <span sdata="cer" target="P:ElecNetKit.NetworkModelling.NetworkElement.ConnectedToPhased"><a href="P_ElecNetKit_NetworkModelling_NetworkElement_ConnectedToPhased.htm" target="">ConnectedToPhased</a></span>. These <span class="code">Phased</span> properties often have a corresponding aggregate property useful for analysing single-phase or balanced three-phase networks. As an example, <span sdata="cer" target="T:ElecNetKit.NetworkModelling.Bus"><a href="T_ElecNetKit_NetworkModelling_Bus.htm" target="">Bus</a></span> has the property <span sdata="cer" target="P:ElecNetKit.NetworkModelling.Bus.Voltage"><a href="P_ElecNetKit_NetworkModelling_Bus_Voltage.htm" target="">Voltage</a></span>, which specifies the average voltage across all bus phases, as well as the aforementioned <span sdata="cer" target="P:ElecNetKit.NetworkModelling.Bus.VoltagePhased"><a href="P_ElecNetKit_NetworkModelling_Bus_VoltagePhased.htm" target="">VoltagePhased</a></span>. Likewise, <span sdata="cer" target="T:ElecNetKit.NetworkModelling.NetworkElement"><a href="T_ElecNetKit_NetworkModelling_NetworkElement.htm" target="">NetworkElement</a></span> contains the property <span sdata="cer" target="P:ElecNetKit.NetworkModelling.NetworkElement.ConnectedTo"><a href="P_ElecNetKit_NetworkModelling_NetworkElement_ConnectedTo.htm" target="">ConnectedTo</a></span>, which returns all elements connected on any phase, in addition to the phased equivalent <span sdata="cer" target="P:ElecNetKit.NetworkModelling.NetworkElement.ConnectedToPhased"><a href="P_ElecNetKit_NetworkModelling_NetworkElement_ConnectedToPhased.htm" target="">ConnectedToPhased</a></span>.</p><a id="topology"><!----></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Traversing the Network Topology</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"></div><p>
          Upon obtaining a <span sdata="cer" target="T:ElecNetKit.NetworkModelling.NetworkModel"><a href="T_ElecNetKit_NetworkModelling_NetworkModel.htm" target="">NetworkModel</a></span>, networks can be explored in a consistent manner. The <span sdata="cer" target="T:ElecNetKit.NetworkModelling.NetworkModel"><a href="T_ElecNetKit_NetworkModelling_NetworkModel.htm" target="">NetworkModel</a></span> object maintains separate lists of <span sdata="cer" target="T:ElecNetKit.NetworkModelling.Bus"><a href="T_ElecNetKit_NetworkModelling_Bus.htm" target="">Bus</a></span>es, <span sdata="cer" target="T:ElecNetKit.NetworkModelling.Line"><a href="T_ElecNetKit_NetworkModelling_Line.htm" target="">Line</a></span>s, <span sdata="cer" target="T:ElecNetKit.NetworkModelling.Generator"><a href="T_ElecNetKit_NetworkModelling_Generator.htm" target="">Generator</a></span>s and <span sdata="cer" target="T:ElecNetKit.NetworkModelling.Load"><a href="T_ElecNetKit_NetworkModelling_Load.htm" target="">Load</a></span>s, and the relationships between them. Each network element has
          the property <span sdata="cer" target="P:ElecNetKit.NetworkModelling.NetworkElement.ConnectedTo"><a href="P_ElecNetKit_NetworkModelling_NetworkElement_ConnectedTo.htm" target="">ConnectedTo</a></span>, which maintains a list of all <span sdata="cer" target="T:ElecNetKit.NetworkModelling.NetworkElement"><a href="T_ElecNetKit_NetworkModelling_NetworkElement.htm" target="">NetworkElement</a></span>s that a specific element is connected to. When used in conjunction with <img src="./../icons/online_icon.gif" class="OH_offlineIcon" alt="Online" title="Online" /><a class="mtps-external-link" href="http://msdn.microsoft.com/en-us/library/vstudio/bb397926.aspx" target="_blank">LINQ</a>, means that executing complex queries for circuit details
          can be done in very few lines of code. It is strongly recommended that users familiarise themselves with LINQ if planning to traverse network topologies in ElecNetKit. The <a href="#seeAlsoSection" target="">Related Content</a> section contains a number of resources useful for understanding LINQ.
        </p><p>
          As an example of ElecNetKit model traversal, the code below finds all lines connected to a bus where
          the voltage is higher at the other end. This could be used iteratively, for example,
          to analytically detect the presence of DG when coordinated between a subset of
          network buses.
        </p><div id="ID0EBCAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EBCAAAAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EBCAAAAA_tabimgleft"></div><div id="ID0EBCAAAAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EBCAAAAA','C#','1','4');return false;">C#</a></div><div id="ID0EBCAAAAA_tab2" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>VB</a></div><div id="ID0EBCAAAAA_tab3" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>C++</a></div><div id="ID0EBCAAAAA_tab4" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EBCAAAAA_tabimgright"></div></div><div id="ID0EBCAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EBCAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EBCAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EBCAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EBCAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EBCAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EBCAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EBCAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre>Bus myBus = Circuit.Buses[<span class="highlight-literal">"myBus"</span>];
<span class="highlight-comment">//Find all connected lines where:</span>
myBus.ConnectedTo.OfType&lt;Line&gt;().Where(
  <span class="highlight-comment">//the other bus the line connects to</span>
  line =&gt; line.ConnectedTo.OfType&lt;Bus&gt;().Where(x =&gt; x != myBus)
  .First() <span class="highlight-comment">//Convert from list to single element</span> 
  <span class="highlight-comment">//check to see if the connected bus has a higher voltage than myBus.</span>
  .Voltage.Magnitude &gt; myBus.Voltage.Magnitude 
);</pre></div><div id="ID0EBCAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>Bus myBus = Circuit.Buses["myBus"];
//Find all connected lines where:
myBus.ConnectedTo.OfType&lt;Line&gt;().Where(
  //the other bus the line connects to
  line =&gt; line.ConnectedTo.OfType&lt;Bus&gt;().Where(x =&gt; x != myBus)
  .First() //Convert from list to single element 
  //check to see if the connected bus has a higher voltage than myBus.
  .Voltage.Magnitude &gt; myBus.Voltage.Magnitude 
);</pre></div><div id="ID0EBCAAAAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBCAAAAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBCAAAAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBCAAAAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBCAAAAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0EBCAAAAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div></div></div><script>addSpecificTextLanguageTagSet('ID0EBCAAAAA');</script><p>As of version 1.1, <span sdata="cer" target="T:ElecNetKit.NetworkModelling.NetworkModel"><a href="T_ElecNetKit_NetworkModelling_NetworkModel.htm" target="">NetworkModel</a></span>s can also be traversed using the phased property <span sdata="cer" target="P:ElecNetKit.NetworkModelling.NetworkElement.ConnectedToPhased"><a href="P_ElecNetKit_NetworkModelling_NetworkElement_ConnectedToPhased.htm" target="">ConnectedToPhased</a></span>. The object model for phased connections is slightly different, with each element of <span sdata="cer" target="P:ElecNetKit.NetworkModelling.NetworkElement.ConnectedToPhased"><a href="P_ElecNetKit_NetworkModelling_NetworkElement_ConnectedToPhased.htm" target="">ConnectedToPhased</a></span> specifying a target element and a target phase (see <span sdata="cer" target="T:ElecNetKit.NetworkModelling.NetworkElementConnection"><a href="T_ElecNetKit_NetworkModelling_NetworkElementConnection.htm" target="">NetworkElementConnection</a></span>).</p><a name="seeAlsoSection"><!----></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">See Also</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"></div><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><img src="./../icons/online_icon.gif" class="OH_offlineIcon" alt="Online" title="Online" /><a class="mtps-external-link" href="http://msdn.microsoft.com/en-us/library/vstudio/bb397926.aspx" target="_blank">LINQ on MSDN</a></div><div class="seeAlsoStyle"><img src="./../icons/online_icon.gif" class="OH_offlineIcon" alt="Online" title="Online" /><a class="mtps-external-link" href="http://msdn.microsoft.com/en-us/library/vstudio/bb397933.aspx" target="_blank">Getting started with LINQ (C#) on MSDN</a></div></div></div></div></div><div id="OH_footer" class="OH_footer"><p /><div class="OH_feedbacklink"><a href="mailto:?subject=ElecNetKit+Documentation+Traversing+the+Network+Model+100+EN-US&amp;body=Your%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report%2c%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed%2c%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed."></a></div></div></body></html>